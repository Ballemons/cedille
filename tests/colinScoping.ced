module Tests.ColinScoping.
% Yes, this is a lazy (in the non-programming sense of the word) to get tail
cList ◂ ★ = ∀ X : ★ . X ➔ X .

cNil ◂ cList = Λ X . λ n . n .

cListParametric ◂ cList ➔ ★ =
  λ l : cList . ∀ X : ★ . ∀ Q : X ➔ ★ .∀ nil : X .
 Q nil ➔ Q (l · X nil) .

List ◂ ★ = ι x : cList .
  ι _ : x cNil ≃ x . cListParametric x .

Nil ◂ List = [ cNil , [ β{cNil} , Λ Q . Λ Q .Λ nil . λ n . n ] ].

% It appears that this is being used below even when there is a Λ P.
% If you comment this out, the code below will work.

P ◂ List = Nil .

ListInd ◂ Π l : List .
          ∀ P : List ➔ ★ .
          P Nil ➔
          P l = λ l . Λ P . λ n .
            % It looks like Λ P isn't shadowing the global P...
	    ρ ς l.2.1 - (l.2.2 · List · P -Nil n) .
